<!DOCTYPE html>
<html>

<head>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f2f2f2;
        }

        .container {
            margin-top: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .title {
            font-size: 60px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .coordinates {
            width: auto;
            font-size: 20px;
            padding: 10px 20px;
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
        }

        .smallT {
            font-size: 20px;
        }

        @keyframes fade {
            from {
                opacity: 1;
            }

            to {
                opacity: 0.5;
            }
        }
    </style>
</head>

<body>
    <script src="stuquery.min.js"></script>
    <script src="virtualsky.js" type="text/javascript"></script>

    <div class="container">
        <div class="title">.</div>
        <div>
            <div class="coordinates" id="alt">ALT: 0.0</div>
            <div class="coordinates" id="az">AZ : 0.0</div>
            <div class="coordinates smallT" id="radec_elm">RA: 0.0 DEC:0.0</div>
        </div>
    </div>

    <div class="slider">
        <label for="slider1">AZ :</label>
        <input type="input" id="slider1" min="0" max="360">
    </div>

    <div class="slider">
        <label for="slider2">ALT:</label>
        <input type="input" id="slider2" min="-90" max="90">
    </div>

    <script>
        var planetarium;
        const smoothingFactor = 0.95;
        let smoothedOrientation = { alpha: 0, beta: 0, gamma: 0 };
        var alt, az, radec, alt_elm, az_elm, radec_elm

        alt_elm = document.getElementById('alt')
        az_elm = document.getElementById('az')
        radec_elm = document.getElementById('radec_elm')
        // dump = document.getElementById('dump')

        const slider1 = document.getElementById('slider1');
        const slider2 = document.getElementById('slider2');

        function degToRad(degrees) {
            return (degrees % 360) * (Math.PI / 180);
        }

        S(document).ready(function () {
            planetarium = S.virtualsky({
                'id': 'starmap',
                'projection': 'gnomic',
                'latitude': -31.75,
                'longitude': -52.33,
                'constellations': true,
                // 'constellationlabels': true,
                'showgalaxy': true,
                'showstarlabels': true,
                'ground': false,
                'fov': 60,
                'fontsize': '10px',
                'live': true,
                'keyboard': true,
                'mouse': true,
                'magnitude': 10,
                'scalestars': 2,
                'showdate': true,
                'showposition': true,
                // 'gridlines_az': true,
                // 'gridlines_eq': true,
                'gridlineswidth': 2,
                'gridstep': 10,
                'atmos': true,
                'objects': "M45;"

            });

            window.addEventListener('deviceorientation', event => {
                const { alpha, beta, gamma } = event;
                smoothedOrientation = {
                    alpha: (smoothingFactor * smoothedOrientation.alpha) + ((1 - smoothingFactor) * alpha),
                    beta: (smoothingFactor * smoothedOrientation.beta) + ((1 - smoothingFactor) * beta),
                };

                az = smoothedOrientation.alpha.toFixed(1)
                alt = smoothedOrientation.beta.toFixed(1)

                alt_elm.innerText = `AZ : ${az}`;
                az_elm.innerText = `ALT: ${alt}`;

                radec = planetarium.azel2radec(degToRad(az), degToRad(alt))
                radec_elm.innerText = `RA: ${radec['ra']}\t DEC: ${radec['dec']}`

                planetarium.panTo(c['ra'], c['dec'], 1)

            });

            az = 323
            alt = 23
            az_elm.innerText = `AZ : ${az}`;
            alt_elm.innerText = `ALT: ${alt}`;

            radec = planetarium.azel2radec(degToRad(az), degToRad(alt))
            radec_elm.innerText = `RA : ${radec['ra'].toFixed(1)}\t DEC: ${radec['dec'].toFixed(1)}`
            planetarium.panTo(radec['ra'], radec['dec'], 500)
        });


        slider1.addEventListener('input', () => {
            az = slider1.value
            az_elm.innerText = `AZ : ${az}`;

            radec = planetarium.azel2radec(degToRad(az), degToRad(alt))
            radec_elm.innerText = `RA : ${radec['ra'].toFixed(1)}\t DEC: ${radec['dec'].toFixed(1)}`
            planetarium.panTo(radec['ra'], radec['dec'], 100)
        });

        slider2.addEventListener('input', () => {
            alt = slider2.value
            alt_elm.innerText = `ALT: ${alt}`;

            radec = planetarium.azel2radec(degToRad(az), degToRad(alt))
            radec_elm.innerText = `RA : ${radec['ra'].toFixed(1)}\t DEC: ${radec['dec'].toFixed(1)}`
            planetarium.panTo(radec['ra'], radec['dec'], 100)
        });

    </script>
    <div id="starmap" style="width:100%;height:300px"></div>
</body>

</html>